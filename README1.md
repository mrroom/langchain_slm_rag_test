# 한국어 문서 검색 시스템

이 프로젝트는 한국어 문서의 의미 기반 검색을 위한 벡터 데이터베이스 시스템입니다. PostgreSQL과 pgvector를 사용하여 문서를 저장하고 검색하며, 한국어에 최적화된 임베딩 모델을 활용합니다.

## 주요 기능

### 1. 문서 임베딩
- 한국어 특화 임베딩 모델 (`jhgan/ko-sroberta-multitask`) 사용
- CPU 환경에 최적화된 경량 처리
- 문서 자동 분할 및 청크 처리

### 2. 벡터 데이터베이스
- PostgreSQL + pgvector 활용
- 효율적인 벡터 유사도 검색
- 메타데이터 저장 및 관리

### 3. 검색 기능
- 의미 기반 유사도 검색
- 점수 기반 필터링
- 상위 K개 결과 반환

## 시스템 구조

### KoreanVectorDB 클래스
1. **초기화 (`__init__`)**
   - 임베딩 모델 로드
   - 데이터베이스 연결 설정

2. **텍스트 처리 (`preprocess_text`)**
   - 텍스트 정규화
   - 공백 처리
   - 유효성 검사

3. **문서 생성 (`create_documents`)**
   - 메타데이터 추가
   - 문서 객체 생성
   - 전처리 적용

4. **문서 추가 (`add_documents`)**
   - 문서 청크 분할
   - 벡터 저장소 저장
   - 처리 결과 반환

5. **검색 (`search`)**
   - 쿼리 전처리
   - 유사도 기반 검색
   - 결과 필터링 및 정렬

## 사용 예시

```python
# 데이터베이스 초기화
db = KoreanVectorDB()

# 문서 추가
texts = [
    "오늘 날씨가 매우 좋아서 공원에서 산책을 했습니다.",
    "비가 와서 실내에서 책을 읽으며 시간을 보냈습니다."
]
db.add_documents(texts)

# 검색 수행
results = db.search("날씨가 좋은 날 야외 활동")
```

## 설치 요구사항

### 1. 시스템 요구사항
- Python 3.7+
- PostgreSQL 11+
- pgvector 확장

### 2. Python 패키지
```text
langchain>=0.1.0
psycopg2-binary>=2.9.9
pgvector>=0.2.4
torch>=2.0.0
transformers>=4.30.0
sentence-transformers>=2.2.2
```

### 3. 데이터베이스 설정
```sql
CREATE DATABASE your_db_name;
\c your_db_name
CREATE EXTENSION vector;
```

## 성능 최적화

1. **메모리 사용**
   - 배치 처리 적용
   - 청크 크기 최적화
   - 주기적 메모리 정리

2. **검색 정확도**
   - 점수 임계값 필터링
   - 전처리 강화
   - 메타데이터 활용

3. **처리 속도**
   - 비동기 처리 가능
   - 인덱싱 최적화
   - 캐싱 적용

## 주의사항

1. **데이터베이스 연결**
   - CONNECTION_STRING 환경 설정 필요
   - 적절한 권한 설정 확인

2. **리소스 관리**
   - 메모리 사용량 모니터링
   - 청크 크기 조정
   - 배치 크기 최적화

3. **에러 처리**
   - 입력 데이터 검증
   - 예외 상황 처리
   - 로깅 구현

## 향후 개선 사항

1. 비동기 처리 구현
2. 캐싱 시스템 도입
3. API 인터페이스 제공
4. 더 다양한 임베딩 모델 지원
5. 성능 모니터링 도구 추가

## 라이선스
MIT License 